"use strict";define(["module","common/fusion/fusion","common/pointerevents/pointerevents","./lang"],(function(e,t,n,i){var a,l,o,s,r,c,d,u,v,h,g=document.createElement("div"),f=document.createElement("div"),p=t.makeSvg("mdiChevronLeft",3),m=t.makeSvg("mdiChevronRight",3),y=document.createElement("div"),x=document.createElement("button"),C=document.createElement("button"),b=32,k=new MutationObserver((function(e){for(var t=0;t<e.length;t++)"attributes"===e[t].type&&T(e[t].target)})),E={init:function(e){e.addEventListener("click",L),T(e),k.observe(e,{attributes:!0,attributeFilter:["value","data-options","data-required"]})},action:function(e){return t.htmlDialog([g,f,y,p,m],"selectDialog",q,(function(){if(e.dataset?(o=(a=e).dataset,s=o.options.parseJsex().value):(a=o=e,s=o.options),Array.isArray(s)){r=s,s={},d=0;for(var n=0;n<r.length;n++)s[r[n]]=r[n],a.value===r[n]&&(d=n)}else r=Object.keys(s),(d=r.indexOf(a.value))<0&&(d=0);if(l=r.length>8?9:r.length>6?7:r.length>4?5:r.length?3:0){if(u=(l-1)/2,f.style.height=l*b+2+"px",r.length<l){for(var c="",v=0;v<r.length;v++)c+="<div>".concat(s[r[v]],"</div>");f.innerHTML=c,0===d&&(f.firstChild.style.marginTop="32px")}else f.innerHTML=N(d);g.textContent=o.title||o.placeholder||i.choose,x.textContent=o.ok||i.ok,x.disabled=o===a?o.notok:"notok"in o,C.textContent=o.clear||i.clear,C.style.display=(o===a?o.required:"required"in o)||!a.value||1===r.length?"none":"",p.style.visibility="function"==typeof o.onprev?"visible":"",m.style.visibility="function"==typeof o.onnext?"visible":""}else t.closeDialog()}))}};return t.appendCss(require.toUrl(e.id)),g.className="title",f.className="content",y.className="btns",C.className="clear",x.className="ok",x.type=C.type="button",p.classList.add("prev"),m.classList.add("next"),y.appendChild(C),y.appendChild(x),f.addEventListener("transitionend",(function(e){r.length<l?e.target.style.transition="":e.target.style.marginTop?e.target.remove():(e.target.style.transition="",this.lastChild.remove())})),x.onclick=function(){this.disabled||t.closeDialog("ok")},C.onclick=function(){t.closeDialog("clear")},p.onclick=function(){t.closeDialog("prev")},m.onclick=function(){t.closeDialog("next")},n(f,(function(e){if(r.length>1)if("start"===e.type){if(!this.pointers.length)return e.domEvent.preventDefault(),r.length<l?h=f.firstChild.offsetTop:(v=d,h=0),c=e.y,!0}else if("move"===e.type){var t=e.y-c;r.length<l?f.firstChild.style.marginTop=Math.min(Math.max(0,h+t),b)+"px":((h=t%b)>0&&(h-=b),(v=(d-Math.floor(t/b))%r.length)<0&&(v+=r.length),f.innerHTML=N(v,h))}else r.length<l?((h=f.firstChild.offsetTop)%b&&(h=Math.round(h/b),M()),d=0===h?1:0):h?(M(),d=(v-1-Math.round(h/b)+r.length)%r.length):d=v})),E;function M(){f.firstChild.style.marginTop=-h>16?"-32px":"",f.firstChild.style.transition="margin-top 100ms ease-in-out"}function T(e){if(e.dataset.options){var t=e.dataset.options.parseJsex().value;if(Array.isArray(t))t.indexOf(e.value)<0?"required"in e.dataset&&t.length?e.textContent=e.value=t[0]:D(e):e.textContent=e.value;else if(e.value in t)e.textContent=t[e.value];else{var n;for(var i in t){n=i;break}"required"in e.dataset&&n?(e.value=n,e.textContent=t[n]):D(e)}var a="required"in e.dataset&&!e.value;e.setCustomValidity({valueMissing:a,valid:!a})}}function D(e){e.value&&(e.value=""),e.textContent=""}function L(){!this.disabled&&this.dataset.options&&E.action(this)}function q(e){var n;e&&("ok"===e||"next"===e?a.value!==r[d]&&(n=!0,a.value=r[d]):"clear"===e&&""!==a.value&&(n=!0,a.value=""),a===o?(n&&t.listeners.trigger(a,"change"),t.listeners.trigger(a,e)):(n&&a.dispatchEvent(new Event("change")),a.dispatchEvent(new Event(e))))}function N(e,t){var n,i;t?(r.length>l?(i=e-u-1)<0&&(i+=r.length):i=(e+u)%r.length,n='<div style="margin-top:'.concat(t,'px">').concat(s[r[i]],"</div>")):n="";for(var a=e-u;a<=e+u;a++){var o=a%r.length;o<0&&(o+=r.length),n+="<div>".concat(s[r[o]],"</div>")}return n}}));